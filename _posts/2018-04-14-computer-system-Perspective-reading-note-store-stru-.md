---
layout: post
title: '深入理解计算机系统-存储器层次结构'
subtitle: '读书笔记系列深入理解计算机系统之存储器层次结构'
date: 2018-04-14
categories: 计算机系统
author: yates
cover: ''
tags: 计算机系统
---

# 前言
存储器系统是一个具有**不同容量，成本和访问时间**的存储设备的层次结构。高层次相对于低层次的存取效率更高一些，但是每个比特位更贵一些。

## 随机访问存储器
随机访问存储器（RAM）分为两类：静态和动态。静态比动态更快，但也更贵。前者用来作为高速缓存存储器，经常位于cpu上火左右；后者用来作为主存和图形系统帧缓冲区。

### 静态RAM
SRAM将每个位存储在一个双稳态单元，这个单元由六个晶体管组成，始终在任何时候都只有两个稳定的配置和状态。

### 动态RAM
DRAM将每个位存储为对一个电容的充电，每个单元由一个电容和一个访问晶体管组成。其特点时对干扰敏感，当电容电压被扰乱后，永远不会恢复，内存系统通过周期性的读出，重写刷新内存每一位或使用纠错码来保证进行纠正。

**传统DRAM**
DRAM芯片中单元（位）被分成d个超单元，每个超单元由W个DRAM单元组成。超单元被组织成一个r行c列的长方形阵列.如图：

![此处输入图片的描述](http://pev96mxgw.bkt.clouddn.com/img/computer-system-Perspective/11.png)
这是一个16x8的DRAM芯片组织，16个超单元，每个单元8位。信息通过**引脚**流入流出，每个引脚携带一个位。下图由2个地址引脚，8个数据引脚，其他控制信息引脚未给出。每个DRAM芯片被连接**内存控制器**的电路，这个电路一次传送w位到每个DRAM芯片或从芯片读取w位。

首先，通过传送2位addr地址获取指定行所有超单元信息，复制到**内部缓冲区**，然后传送2位指定列从内部缓冲区获取指定超单元信息，通过data引脚传送出去，做成行列结构而不是一行可以节省2个引脚，但是需要两次传送addr信息。

**内存模块**
DRAM芯片封装在内存模块中，插到主板的扩展槽上，i7使用240引脚双列直插内存，以64位块作为块传送数据到内存控制器。如图：
![此处输入图片的描述](http://pev96mxgw.bkt.clouddn.com/img/computer-system-Perspective/12.png)

该模块用了8个64Mbit的8Mx8DRAM芯片，总共64MB数据，每个超单元存储8位，总共8个芯片8个超单元64位数据，按照高低位排序传输。

**增强DRAM**
- 快页模式，在传统的DRAM模式中因为行缓冲区，用一次后就会丢弃，如果从同一个行读4个超单元，需要发送4次RAS/CAS请求，在快页模式下，行缓冲区得到重复利用，只需要发送一次RAS/CAS和后面跟3个CAS
- 扩展数据输出，允许各个CAS信号在时间上靠的更紧密一点
- 同步DRAM，和内存控制器通信使用一组显式控制信号，最终比一般的异步存储器更快输出超单元内容
- 双倍数据速率同步，使用两个时钟沿作为控制信号，从而使DRAM速度翻倍。
- 视频RAM，用在图形系统帧缓冲区，输出通过依次对内部缓冲区整个内容进行移位和允许对内存并行读和写。

**非易失去性存储器**
如果断电，SRAM和DRAM会失去信息，非易失去性存储器即使在关电后，仍然保持信息。比如ROM只读存储器，ROM通过能够被重写次数和进行重写所用机制进行区分分为可擦写可编程ROM，闪存（固态硬盘）。ROM中存储的程序称为固件。

**访问主存**

数据通过总线在处理器和DRAM主存之间传输。传输过程可分为读事务，写事务。如图：

![此处输入图片的描述](http://pev96mxgw.bkt.clouddn.com/img/computer-system-Perspective/13.png)
I/O桥接器负责系统总线电子信号和内存总线电子信号之间的转换

## 磁盘存储