---
layout: post
title: '深入理解计算机系统-高速缓存器'
subtitle: '读书笔记系列深入理解计算机系统之IO'
date: 2018-04-22
categories: 计算机系统
author: yates
cover: ''
tags: 计算机系统
--


## 前言
输入输出(I/O)是主存和外部设备（磁盘，终端，网络）之间复制的过程。

## Unix I/O
所有语言都提供执行I/O的工具。ANSI C提供标准I/O库，在Linux系统中，通过内核提供系统级I/O库，在Linux系统中，通过内核提供系统级I/O函数。
所哟I/O设备都被模拟为文件，Linux内核提供一个简单，低级的应用接口，通过统一的输入，输出方式来执行。
- 打开文件，应用访问文件，内核返回一个非负整数，标识这个文件，叫做描述符。
- shell创建进程都会打开三个文件，标准输入，标准输出，标准异常
- 改变当前文件地址，每个打开的文件内核都保持一个文件位置k，初始为0.表示从文件开头起始的字节偏移量。
- 读写文件，读操作从文件复制n个字节到内存，从当前文件位置k开始，然后增加k到k+n，给定一个m字节的文件，当k>m时读操作触发eof条件；写操作从内存复制n字节到文件，更新k值。
- 关闭文件，当完成访问后，通知内核关闭文件，内核释放文件打开时创建的数据结构，并将描述符恢复到可用的描述符池中。

## 文件
每个linux文件有一个类型表示身份
- 普通文件，包含任何数据，分为文本文件和二进制文件，对内核来说没有区别。
- 目录，包含一组链接的文件，每个链接映射到一个文件。每个目录至少有两个条目,"."和“..”分别表示自身链接和上一级目录链接
- 套接字，用来和另一个进程进行通信的文件
- 还有例如，命名通道，符号链接，字符和块设备等

内核组织所有文件位一个额目录层次结构，每个文件都直接或间接是根目录的后代。目录之间通过绝对路径名和相对路径名

**不足值**
linux内核打开，关闭，读写文件都以不同函数，不同参数来进行，有些情况下，read读函数和wirte写函数传送字节比应用程序要求的少，称为不足值。
- 在读中可能会遇到EOF，比如读取只含20字节文件，以50字节读取，当读到20时read返回不足值0发出EOF信号
- 终端读取文本行，read函数一次传送一个文本行，不足值代表文本行大小
- 读写网络延迟时会返回不足值

**RIO**
通过RIO自动处理上面的不足值，RIO提供两类函数
- 无缓冲输入输出函数，直接在内存和文件之间传送数据，没有应用级缓冲。多用于读写网络中数据
- 带缓冲输入函数。提供应用级缓冲区，多用于文件中读取文本行和二进制数据。

除此外linux海通，读取文件元数据，读取目录和内容，以及I/O重定向的函数

java，c等语言基于Unix I/O的实现，提供了比Unix I/O更高级别的代替，更简单，但是由于标准I/O和网络文件一些互不相容的限制，Unix I/O比标准I/O更适合网络应用程序






















